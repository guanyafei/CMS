var blobSlice=window.File&&(File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice)||function(){},UTIL=UTIL||{addDomEvent:function(t,e,n,r){var i=e;t.addEventListener?t.addEventListener(i,n,r):t.attachEvent&&(i="on"+i,t.attachEvent(i,function(){n.call(t,arguments[0])}))},removeDomEvent:function(t,e,n){t.removeEventListener?t.removeEventListener(e,n):t.detachEvent&&t.detachEvent("on"+e,n)},paramsToURIComps:function(t,e){var n=[],r="";for(var i in t)r=t[i],e&&(r=encodeURIComponent(r)),n.push(i+"="+r);return"?"+n.join("&")},paramsToURIEncoding:function(t){for(var e in t)t[e]=encodeURIComponent(t[e])},fixedEvent:function(t){t||(t=window.event),t.target||(t.target=t.srcElement),t.stopPropagation||(t.stopPropagation=function(){t.cancelBubble=!0}),t.preventDefault||(t.preventDefault=function(){return t.returnValue=!1,!1})},isIEVersion:function(){var t={5.5:"5.5",5.6:"6",5.7:"7",5.8:"8",9:"9",10:"10",11:"11"},e=new Function("/*@cc_on return @_jscript_version; @*/")();return e?t[e]:-1}(),isIE:function(){var t=navigator.userAgent.toLowerCase();return!(!t.match(/rv:([\d.]+)\) like gecko/)&&!t.match(/msie ([\d.]+)/))}(),isIE9:function(){return navigator&&navigator.userAgent.match(/msie/i)&&navigator.appVersion.match(/MSIE 9.0/i)}(),ensureAfterDomRenderer:function(t,e,n){t&&setTimeout(function(){t.call(e,e)},n||0)}},UTIL=UTIL||{};UTIL.dom=UTIL.dom||{genCurrentStyle:function(t){return document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t,null):t&&t.currentStyle?t.currentStyle:null},filterElemByClass:function(t,e,n){for(var r=t.getElementsByTagName(e)||[],i=[],a={},o=new RegExp("\\b"+n+"\\b","g"),s=0,u=r.length;s<u;s++)(a=r[s])&&a.className&&o.test(a.className)&&i.push(a);return i},filterElemByAttrVal:function(t,e,n,r){for(var i=t.getElementsByTagName(e)||[],a=[],o={},s=0,u=i.length;s<u;s++)(o=i[s])&&(o[n]&&o[n].indexOf(r)>-1||o.getAttribute&&o.getAttribute(n)&&o.getAttribute(n).indexOf(r)>-1)&&a.push(o);return a},filterElemByAttrValExact:function(t,e,n,r){for(var i=t.getElementsByTagName(e)||[],a=[],o={},s=0,u=i.length;s<u;s++)(o=i[s])&&(o[n]&&o[n]==r||o.getAttribute&&o.getAttribute(n)&&o.getAttribute(n)==r)&&a.push(o);return a},addClass:function(t,e){if(!UTIL.dom.hasClass(t,e)){var n=t.className;n=n?n+" "+e:e,t.className=n}},removeClass:function(t,e){var n=new RegExp(e,"gi");t.className=t.className.replace(n,"")},hasClass:function(t,e){var n=new RegExp(e,"gi"),r=t.className;return n.test(r)}};var CryptoJS=CryptoJS||function(t,e){var n={},r=n.lib={},i=function(){},a=r.Base={extend:function(t){i.prototype=this;var e=new i;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes;if(t=t.sigBytes,this.clamp(),r%4)for(var i=0;i<t;i++)e[r+i>>>2]|=(n[i>>>2]>>>24-i%4*8&255)<<24-(r+i)%4*8;else if(65535<n.length)for(i=0;i<t;i+=4)e[r+i>>>2]=n[i>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],r=0;r<e;r+=4)n.push(4294967296*t.random()|0);return new o.init(n,e)}}),s=n.enc={},u=s.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],r=0;r<t;r++){var i=e[r>>>2]>>>24-r%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new o.init(n,e/2)}},l=s.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],r=0;r<t;r++)n.push(String.fromCharCode(e[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new o.init(n,e)}},f=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},h=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=f.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,r=n.words,i=n.sigBytes,a=this.blockSize,s=i/(4*a),s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0);if(e=s*a,i=t.min(4*e,i),e){for(var u=0;u<e;u+=a)this._doProcessBlock(r,u);u=r.splice(0,e),n.sigBytes-=i}return new o.init(u,i)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});r.Hasher=h.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new c.HMAC.init(t,n).finalize(e)}}});var c=n.algo={};return n}(Math);!function(){var t=CryptoJS,e=t.lib,n=e.WordArray,r=e.Hasher,i=[],e=t.algo.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],a=n[1],o=n[2],s=n[3],u=n[4],l=0;80>l;l++){if(16>l)i[l]=0|t[e+l];else{var f=i[l-3]^i[l-8]^i[l-14]^i[l-16];i[l]=f<<1|f>>>31}f=(r<<5|r>>>27)+u+i[l],f=20>l?f+(1518500249+(a&o|~a&s)):40>l?f+(1859775393+(a^o^s)):60>l?f+((a&o|a&s|o&s)-1894007588):f+((a^o^s)-899497514),u=s,s=o,o=a<<30|a>>>2,a=r,r=f}n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(r+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=r._createHelper(e),t.HmacSHA1=r._createHmacHelper(e)}(),function(){if("function"==typeof ArrayBuffer){var t=CryptoJS,e=t.lib,n=e.WordArray,r=n.init;(n.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var e=t.byteLength,n=[],i=0;i<e;i++)n[i>>>2]|=t[i]<<24-i%4*8;r.call(this,n,e)}else r.apply(this,arguments)}).prototype=n}}(),function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;try{e=window}catch(t){e=self}e.SparkMD5=t()}}(function(t){"use strict";function e(t,e,n,r,i,a){return e=S(S(e,t),S(r,a)),S(e<<i|e>>>32-i,n)}function n(t,n,r,i,a,o,s){return e(n&r|~n&i,t,n,a,o,s)}function r(t,n,r,i,a,o,s){return e(n&i|r&~i,t,n,a,o,s)}function i(t,n,r,i,a,o,s){return e(n^r^i,t,n,a,o,s)}function a(t,n,r,i,a,o,s){return e(r^(n|~i),t,n,a,o,s)}function o(t,e){var o=t[0],s=t[1],u=t[2],l=t[3];o=n(o,s,u,l,e[0],7,-680876936),l=n(l,o,s,u,e[1],12,-389564586),u=n(u,l,o,s,e[2],17,606105819),s=n(s,u,l,o,e[3],22,-1044525330),o=n(o,s,u,l,e[4],7,-176418897),l=n(l,o,s,u,e[5],12,1200080426),u=n(u,l,o,s,e[6],17,-1473231341),s=n(s,u,l,o,e[7],22,-45705983),o=n(o,s,u,l,e[8],7,1770035416),l=n(l,o,s,u,e[9],12,-1958414417),u=n(u,l,o,s,e[10],17,-42063),s=n(s,u,l,o,e[11],22,-1990404162),o=n(o,s,u,l,e[12],7,1804603682),l=n(l,o,s,u,e[13],12,-40341101),u=n(u,l,o,s,e[14],17,-1502002290),s=n(s,u,l,o,e[15],22,1236535329),o=r(o,s,u,l,e[1],5,-165796510),l=r(l,o,s,u,e[6],9,-1069501632),u=r(u,l,o,s,e[11],14,643717713),s=r(s,u,l,o,e[0],20,-373897302),o=r(o,s,u,l,e[5],5,-701558691),l=r(l,o,s,u,e[10],9,38016083),u=r(u,l,o,s,e[15],14,-660478335),s=r(s,u,l,o,e[4],20,-405537848),o=r(o,s,u,l,e[9],5,568446438),l=r(l,o,s,u,e[14],9,-1019803690),u=r(u,l,o,s,e[3],14,-187363961),s=r(s,u,l,o,e[8],20,1163531501),o=r(o,s,u,l,e[13],5,-1444681467),l=r(l,o,s,u,e[2],9,-51403784),u=r(u,l,o,s,e[7],14,1735328473),s=r(s,u,l,o,e[12],20,-1926607734),o=i(o,s,u,l,e[5],4,-378558),l=i(l,o,s,u,e[8],11,-2022574463),u=i(u,l,o,s,e[11],16,1839030562),s=i(s,u,l,o,e[14],23,-35309556),o=i(o,s,u,l,e[1],4,-1530992060),l=i(l,o,s,u,e[4],11,1272893353),u=i(u,l,o,s,e[7],16,-155497632),s=i(s,u,l,o,e[10],23,-1094730640),o=i(o,s,u,l,e[13],4,681279174),l=i(l,o,s,u,e[0],11,-358537222),u=i(u,l,o,s,e[3],16,-722521979),s=i(s,u,l,o,e[6],23,76029189),o=i(o,s,u,l,e[9],4,-640364487),l=i(l,o,s,u,e[12],11,-421815835),u=i(u,l,o,s,e[15],16,530742520),s=i(s,u,l,o,e[2],23,-995338651),o=a(o,s,u,l,e[0],6,-198630844),l=a(l,o,s,u,e[7],10,1126891415),u=a(u,l,o,s,e[14],15,-1416354905),s=a(s,u,l,o,e[5],21,-57434055),o=a(o,s,u,l,e[12],6,1700485571),l=a(l,o,s,u,e[3],10,-1894986606),u=a(u,l,o,s,e[10],15,-1051523),s=a(s,u,l,o,e[1],21,-2054922799),o=a(o,s,u,l,e[8],6,1873313359),l=a(l,o,s,u,e[15],10,-30611744),u=a(u,l,o,s,e[6],15,-1560198380),s=a(s,u,l,o,e[13],21,1309151649),o=a(o,s,u,l,e[4],6,-145523070),l=a(l,o,s,u,e[11],10,-1120210379),u=a(u,l,o,s,e[2],15,718787259),s=a(s,u,l,o,e[9],21,-343485551),t[0]=S(o,t[0]),t[1]=S(s,t[1]),t[2]=S(u,t[2]),t[3]=S(l,t[3])}function s(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function u(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return n}function l(t){var e,n,r,i,a,u,l=t.length,f=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=l;e+=64)o(f,s(t.substring(e-64,e)));for(t=t.substring(e-64),n=t.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<n;e+=1)r[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(o(f,r),e=0;e<16;e+=1)r[e]=0;return i=8*l,i=i.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(i[2],16),u=parseInt(i[1],16)||0,r[14]=a,r[15]=u,o(f,r),f}function f(t){var e,n,r,i,a,s,l=t.length,f=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=l;e+=64)o(f,u(t.subarray(e-64,e)));for(t=e-64<l?t.subarray(e-64):new Uint8Array(0),n=t.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<n;e+=1)r[e>>2]|=t[e]<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(o(f,r),e=0;e<16;e+=1)r[e]=0;return i=8*l,i=i.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(i[2],16),s=parseInt(i[1],16)||0,r[14]=a,r[15]=s,o(f,r),f}function h(t){var e,n="";for(e=0;e<4;e+=1)n+=w[t>>8*e+4&15]+w[t>>8*e&15];return n}function c(t){var e;for(e=0;e<t.length;e+=1)t[e]=h(t[e]);return t.join("")}function p(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function d(t,e){var n,r=t.length,i=new ArrayBuffer(r),a=new Uint8Array(i);for(n=0;n<r;n+=1)a[n]=t.charCodeAt(n);return e?a:i}function g(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function m(t,e,n){var r=new Uint8Array(t.byteLength+e.byteLength);return r.set(new Uint8Array(t)),r.set(new Uint8Array(e),t.byteLength),n?r:r.buffer}function v(t){var e,n=[],r=t.length;for(e=0;e<r-1;e+=2)n.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,n)}function y(){this.reset()}var S=function(t,e){return t+e&4294967295},w=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==c(l("hello"))&&(S=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return t=0|t||0,t<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(n,r){var i,a,o,s,u=this.byteLength,l=e(n,u),f=u;return r!==t&&(f=e(r,u)),l>f?new ArrayBuffer(0):(i=f-l,a=new ArrayBuffer(i),o=new Uint8Array(a),s=new Uint8Array(this,l,i),o.set(s),a)}}(),y.prototype.append=function(t){return this.appendBinary(p(t)),this},y.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,n=this._buff.length;for(e=64;e<=n;e+=64)o(this._hash,s(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},y.prototype.end=function(t){var e,n,r=this._buff,i=r.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i;e+=1)a[e>>2]|=r.charCodeAt(e)<<(e%4<<3);return this._finish(a,i),n=c(this._hash),t&&(n=v(n)),this.reset(),n},y.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},y.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},y.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},y.prototype._finish=function(t,e){var n,r,i,a=e;if(t[a>>2]|=128<<(a%4<<3),a>55)for(o(this._hash,t),a=0;a<16;a+=1)t[a]=0;n=8*this._length,n=n.toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(n[2],16),i=parseInt(n[1],16)||0,t[14]=r,t[15]=i,o(this._hash,t)},y.hash=function(t,e){return y.hashBinary(p(t),e)},y.hashBinary=function(t,e){var n=l(t),r=c(n);return e?v(r):r},y.ArrayBuffer=function(){this.reset()},y.ArrayBuffer.prototype.append=function(t){var e,n=m(this._buff.buffer,t,!0),r=n.length;for(this._length+=t.byteLength,e=64;e<=r;e+=64)o(this._hash,u(n.subarray(e-64,e)));return this._buff=e-64<r?new Uint8Array(n.buffer.slice(e-64)):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(t){var e,n,r=this._buff,i=r.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i;e+=1)a[e>>2]|=r[e]<<(e%4<<3);return this._finish(a,i),n=c(this._hash),t&&(n=v(n)),this.reset(),n},y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.getState=function(){var t=y.prototype.getState.call(this);return t.buff=g(t.buff),t},y.ArrayBuffer.prototype.setState=function(t){return t.buff=d(t.buff,!0),y.prototype.setState.call(this,t)},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.hash=function(t,e){var n=f(new Uint8Array(t)),r=c(n);return e?v(r):r},y}),function(){var t={},e=!1,n=!1,r=UTIL.isIE9,i=(window.alert,function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}()),a=!1,o="http";/https/i.test(""+window.location)&&(o="https");var s=function(){var t=new XMLHttpRequest;return r&&XDomainRequest&&(t=new XDomainRequest),t},u=function(t){var e=[],n=t.params||{},r=t.body||"";for(var i in n)e.push(i+"="+n[i]);var a=s();a.onload=function(){t.callBack&&t.callBack.call(a)},a.onError=function(){},a.open("post",t.url+"?"+e.join("&")),a.send(r)},l=function(t){for(var e="Hy7Gi*cQPMd19XbgRsMno0dz4^sb#sQ0Unx$s!a158ScTuxPk8n6BksTcB$sc^aP",n=t.length,r=e.length,i="",a=0;a<n;a++)i+=String.fromCharCode(t.charAt(a).charCodeAt(0)+e.charAt(a%r).charCodeAt(0));if(!/([^\u0000-\u00ff])/.test(i)){for(var o,s,u,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,f=[];a<i.length;){switch(o=i.charCodeAt(a),u=(a+1)%3){case 1:f.push(l.charAt(o>>2));break;case 2:f.push(l.charAt((3&s)<<4|o>>4));break;case 0:f.push(l.charAt((15&s)<<2|o>>6)),f.push(l.charAt(63&o))}s=o,a++}return 1==u?(f.push(l.charAt((3&s)<<4)),f.push("==")):2==u&&(f.push(l.charAt((15&s)<<2)),f.push("=")),f.join("")}},f=function(n){if(t.lists||(t.lists=[]),e)return t.tempLists||(t.tempLists=[]),void t.tempLists.push(n);t.lists.push(n)},h=function(e){if(e.ut||(e.ut=i),t.errorLists||(t.errorLists=[]),n)return t.tempErrorLists||(t.tempErrorLists=[]),void t.tempErrorLists.push(e);t.errorLists.push(e)},c=function(){if(!e){e=!0;var n=l(JSON.stringify(t.lists));t.lists=[],t.lists=t.lists.concat(t.tempLists),t.tempLists=[],e=!1,u({url:o+"://ppyun.data.pplive.com/1.html",body:n,callBack:function(){}})}},p=function(){if(!n){n=!0;var e=l(JSON.stringify(t.errorLists));t.errorLists=[],t.errorLists=t.errorLists.concat(t.tempErrorLists),t.tempErrorLists=[],n=!1,u({url:"http://ppyun.data.pplive.com/1.html",body:e,callBack:function(){}})}};window.pplog=window.pplog?window.pplog:{addLog:f,addErrorLog:h,sendLog:c,sendErrorLog:p,vvid:i,getList:function(){return t.lists},setIsErrorLog:function(t){a=t}}}(),function(){var t=new FileReader,e=null,n=[],r=[],i=!1,a=0,o=null,s=0,u=null,l=null,f=function(){if(s<=65535)return t.readAsArrayBuffer(l),void(a=5);var e=parseInt(s*a/5),n=e+12288;4==a&&(e=s-12288,n=s),t.readAsArrayBuffer(blobSlice.call(l,e,n))},h=function(){if(!i){var r=n.pop();if(!r)return;t||(t=new FileReader),i=!0,s=r.size,u=CryptoJS.algo.SHA1.create(),l=r.blobFile,o=r.cxnt,e=r,a=0,f()}};t.onload=function(t){var n=CryptoJS.lib.WordArray.create(t.target.result);if(u.update(n),a<5)a++,f();else{var o=u.finalize();o=o.toString(CryptoJS.enc.Hex),e.ppfeature=s+"_"+o,r.push(e.ppfeature),e.onAfterChangeFiles&&e.onAfterChangeFiles(e),i=!1,h()}},t.onerror=function(){t&&t.abort&&t.abort(),t=null},window.featureFile={addTask:function(t){n.push(t)},loadFile:function(){h()}}}(),function(){var t=new FileReader,e=[],n=!1,r=0,i=null,a=null,o=0,s=0,u=null,l=function(){var e=2097152*s,n=e+2097152>=r?r:e+2097152;t.readAsArrayBuffer(blobSlice.call(i,e,n))},f=function(){if(!n){var f=e.pop();if(!f)return;t||(t=new FileReader),n=!0,r=f.size,a=new SparkMD5.ArrayBuffer,i=f.blobFile,s=0,o=Math.ceil(r/2097152),u=f,l()}};t.onload=function(t){if(a.append(t.target.result),++s<o)l();else{var e=a.end();u.makeMD5&&u.makeMD5(e),n=!1,f()}},t.onerror=function(){t&&t.abort&&t.abort(),t=null},window.MD5File=window.MD5File||{addTask:function(t){e.push(t),f()},getList:function(){return e}}}(),function(){var t=function(t){this.fileReader=new FileReader,this.fileInfo=t.fileInfo||{},this.onLoad=t.onLoad||{},this.onError=t.onError||{};var e=this,n=this.fileReader;n.onload=function(t){e.onLoad&&e.onLoad.call(e,e.fileInfo,t),e.fileReader&&e.fileReader.abort&&e.fileReader.abort()},n.onerror=function(){e.onError&&e.onError.call(e),e.fileReader&&e.fileReader.abort&&e.fileReader.abort(),e.fileReader=null}};t.prototype={nextTask:function(t){this.fileReader&&this.fileReader.readAsArrayBuffer(t)}},window.UploadFileMachine=window.UploadFileMachine||t}(),function(){var t=UTIL.addDomEvent,e=UTIL.fixedEvent,n=UTIL.dom.filterElemByAttrVal,r=function(){var t=this.actionMap,e=this.parent,r=[],i=null;for(var a in t){if(r=a.split("."),i=n(e,r[0],r[1],r[2]),l=i.length,l<1)return;for(var o=0;o<l;o++)i[o].setAttribute("data-action",a)}},i=function(){var n=this.actionMap,r=this.actiontype;this.parent&&t(this.parent,r,function(t){e(t);var r=t.target,i=r.getAttribute("data-action");i&&n[i]&&n[i].call(r,r,t)})},a=function(t){this.parent=t.parent||null,this.actiontype=t.actiontype||"click",this.actionMap=t.actionMap||{},this.init()};a.prototype={init:function(){i.call(this),r.call(this)},updateActionMap:function(){r.call(this)}},window.EventService=window.EventService||a}(),function(){var t=""+location.href,e="http://ppc.pptvyun.com";t.indexOf("https")>-1&&(e="https://ppc.pptvyun.com");var n=UTIL.isIE9,r={ppf:10,fid:1,upload:2,unknown:3,getUploadFileRangeError:4,readChunkFileError:5,getUploadTokenError:6,submitMD5Error:7,reportRangeFinishedError:8,uploadFileChuckError:9},i=function(t){for(var e=t,n=["","K","M","G","T","P"],r=0;e>=1024;)e/=1024,r++;return e.toFixed(2)+n[r]+"B"},a=function(){var t=new XMLHttpRequest;return n&&XDomainRequest&&(t=new XDomainRequest),t},o=function(){return+new Date+"_"+parseInt((Math.random()+"").split(".").join(""))},s=function(t){t=t||{},this.summary=t.summary||"",this.channelname=t.channelname||"",this.size=t.size||0,this.changeSize=t.changeSize||"",this.index=t.index>=0?t.index:-1,this.fileInput=t.fileInput||null,this.blobFile=t.blobFile||null,this.fileIndex=t.fileIndex,this.viewNode=t.viewNode||null,this.status=t.status||0,this.customParams=t.customParams||null,this.onProgress=t.onProgress||null,this.onSpeed=t.onSpeed||null,this.onUploadError=t.onUploadError||null,this.afterEachFinished=t.afterEachFinished||null,this.tokenURL=t.tokenURL||null,this.isDebug=t.isDebug,this.isDebug&&(e="http://api.cloudplay.ppqa.com"),this.ppfeature=t.ppfeature,this.isAutoUpload=t.isAutoUpload,this.onUpdateStatus=t.onUpdateStatus||null,this.cusTokenError=t.cusTokenError||null,this.fid=null,this.cid=null,this.rid=null,this.wedid=null,this.coverImage=null,this.uploadFileMachine=null,this.rangeData=null,this.onAfterChangeFiles=t.onAfterChangeFiles||null,this.isMD5Finished=!1,this.isUploaded=!1,this.uploadST=0,this.maxSPS=0,this.minSPS=-1},u=function(){var t=this;MD5File.addTask(t),this.uploadFileMachine=new UploadFileMachine({fileInfo:t,onLoad:function(e,n){t._uploadFile(n)},onError:function(){t.genError({eCode:r.readChunkFileError,msg:"璇诲彇涓婁紶鏂囦欢鍧楅敊璇�"})}}),this.getFileChuckRange()},l=function(){var t=[],e=0,n=function(){e++},r=function(){e--},i=function(e){for(var n=0,r=t.length;n<r;n++)if(t[n]&&e&&e.ppfeature&&e.ppfeature==t[n].ppfeature)return n;return-1},a=function(e){e&&(e.ppfeature?-1==i(e)&&t.push(e):t.push(e))},o=function(e){for(var n=t.length,i=null,a=0;a<n;a++)if((i=t[a])&&e==i.ppfeature){t.splice(a,1,null),r();break}},s=function(t){t&&!t.isUploaded&&2!=t.status&&(t.updateStatus(2),t.token?t.getFileChuckRange():t.getToken(),n())};return{add:n,red:r,nextUpload:function(n){var r=n||null;if(a(r),!(e>=5))if(r)r.getStutas()<=3&&s(r);else for(var i=0,o=t.length;i<o;i++){if(e>=5)return;r=t[i],r&&(r.getStutas()<=1&&s(r))}},rmByPPfeature:o}}(),f=l.rmByPPfeature,h=l.nextUpload;s.prototype={upload:function(){h.call(this,this)},changeBytes:function(t){return i.call(this,t)},getToken:function(){var t=this,e=a(),n=new FormData,i=this.customParams;n.append("ppfeature",this.ppfeature),n.append("name",this.channelname),n.append("summary",this.summary),n.append("coverimg",this.coverimg),n.append("length",this.size),e.onload=function(){var n=JSON.parse(e.responseText?e.responseText:"{}"),i=n.data?n.data:{};if(0==n.err)t.wedid=i.channelWebId,t.fid=i.fId,t.cid=i.cid||i.channel_id,t.rid=i.id,t.userId=i.user_id,i.file_status>=100?(t.minSPS<0&&(t.minSPS=0),t.uploadST=+new Date,t.sendLog(3),t.onProgress&&t.onProgress.call(t,t.size,t.size,0,1),t.afterEachFinished&&(t.updateStatus(4),t.afterEachFinished.call(t,t,t.wedid),f(t.ppfeature),h.call(t))):(t.token=i.upToken,u.call(t));else{if(t.cusTokenError)return t.updateStatus(5),void t.cusTokenError.call(t,n.err,n.msg);t.genError({eCode:r.getUploadTokenError,msg:"鑾峰彇涓婁紶鏂囦欢token閿欒"})}},e.onError=function(){if(t.cusTokenError)return t.updateStatus(5),void t.cusTokenError.call(t,json.err,json.msg);t.genError({eCode:r.getUploadTokenError,msg:"鑾峰彇涓婁紶鏂囦欢token閿欒"})};var s=[];s.push("t="+o());for(var l in i)s.push(l+"="+encodeURIComponent(i[l]));e.open("post",this.tokenURL+"?"+s.join("&")),e.send(n)},makeMD5:function(t){if(3!=this.status){var n=this,i=a();i.onload=function(){var t=JSON.parse(i.responseText?i.responseText:"{}");t.data&&t.data;n.isMD5Finished=!0,n.isUploaded&&(n.updateStatus(4),n.afterEachFinished&&n.afterEachFinished.call(n,n,n.wedid),f(n.ppfeature),h.call(n))},i.onError=function(){n.genError({eCode:r.submitMD5Error,msg:"鎻愪氦鏂囦欢MD5閿欒"})};var s="?md5="+t+"&feature_pplive="+n.ppfeature+"&uptoken="+n.token+"&t="+ +o();i.open("post",e+"/fsvc/3/file/"+n.fid+"/md5"+s),i.send()}},_reportRange:function(t,n,i){var s=this,u=a();u.onload=function(){if(0==JSON.parse(u.responseText?u.responseText:"{}").err)return void s.getFileChuckRange();s.genError({eCode:r.reportRangeFinishedError,msg:"姹囨姤鏂囦欢鍧椾笂浼犲畬鎴愰敊璇�"})},u.onerror=function(){s.genError({eCode:r.reportRangeFinishedError,msg:"姹囨姤鏂囦欢鍧椾笂浼犲畬鎴愰敊璇�"})};var l="?range_md5="+t+"&bid="+n+"&uploadid="+i+"&uptoken="+s.token+"&t="+ +o();u.open("post",e+"/fsvc/3/file/"+s.fid+"/action/uploaded"+l),u.send()},_uploadFile:function(t){if(3!=this.status){var e=this,n=e.size,i=new SparkMD5.ArrayBuffer;i.append(t.target.result);var o=i.end(),s=a();e.updateStatus(2);var u=+new Date;s.onload=function(){if(4===s.readyState)if(s.status>=200&&s.status<300){e._reportRange(o,e.rangeData.bid,s.getResponseHeader("Etag")),u=+new Date-u;var t=e.rangeData.end-e.rangeData.start,i=t/u;if(e.minSPS<0&&(e.minSPS=i),e.maxSPS=parseInt(e.maxSPS<=i?i:e.maxSPS),e.minSPS=parseInt(e.minSPS>=i?i:e.minSPS),e.onProgress){var a=e.rangeData.finished+t;a=a>=n?n:a,n&&e.onProgress.call(e,a,n,t,u)}}else e.genError({eCode:r.uploadFileChuckError,msg:"涓婁紶鏂囦欢鍧楅敊璇�"})},s.onerror=function(){e.genError({eCode:r.uploadFileChuckError,msg:"涓婁紶鏂囦欢鍧楅敊璇�"})},s.open("put",this.rangeData.upload_url,!0),s.setRequestHeader("Etag",o),s.setRequestHeader("Authorization",e.token),this.uploadST||(this.uploadST=+new Date),s.send(this.rangeData.chunk)}},getFileChuckRange:function(){if(3!=this.status){var t=this,n=a();n.onload=function(){var e=JSON.parse(n.responseText?n.responseText:"{}");if(0!=e.err)return void t.genError({eCode:r.getUploadFileRangeError,msg:"鑾峰彇涓婁紶鏂囦欢鑼冨洿閿欒"});var i=e.data?e.data:{},a=t.size,o=i.finished?i.finished:0;if(3==t.status)return void n.abort();if(o<a)t.makeUploadLine(i);else{if(t.updateStatus(4),"length"in i.ranges&&i.ranges.length>0)return void t.makeUploadLine(i);t.isUploaded=!0,t.sendLog(),!i.needMD5||t.isMD5Finished?(t.afterEachFinished&&t.afterEachFinished.call(t,t,t.wedid),f(t.ppfeature),h.call(t)):t.updateStatus(6),t.onProgress&&t.onProgress.call(t,o,a,0,1)}},n.onError=function(){t.genError({eCode:r.getUploadFileRangeError,msg:"鑾峰彇涓婁紶鏂囦欢鑼冨洿閿欒"})};var i="?feature_pplive="+this.ppfeature+"&uptoken="+t.token+"&fromcp=ppcloud&inner=false&t="+ +o();n.open("get",e+"/fsvc/3/file/"+t.fid+"/action/uploadrange"+i),n.send()}},makeUploadLine:function(t){var e=this;if(!t&&!t.ranges)return void e.genError({eCode:r.getUploadFileRangeError,msg:"鑾峰彇涓婁紶鏂囦欢鑼冨洿閿欒"});if("length"in t.ranges&&t.ranges.length>0){var n=t.ranges[0].start,i=t.ranges[0].end;t.ranges[0].bid,t.ranges[0].upload_url;this.rangeData=t.ranges[0],this.rangeData.finished=t.finished?t.finished:0,this.rangeData.chunk=blobSlice.call(e.blobFile,n,i+1),this.uploadFileMachine.nextTask(this.rangeData.chunk)}else e.getFileChuckRange()},setPause:function(t){this.updateStatus(t),l.red(),h()},getStutas:function(){return this.status},updateStatus:function(t){this.status!=t&&(this.status=t,this.onUpdateStatus&&this.onUpdateStatus.call(this,t))},genError:function(t){var e=this,n={e_10:"get ppfture failed",e_1:"get fid failed",e_2:"upload failed",e_3:"unknown error",e_4:"get Upload File Range Error",e_5:"read Chunk File Error",e_6:"get Upload Token Error",e_7:"submit MD5 Error",e_8:"report Range Finished Error",e_9:"upload File Chuck Error"};e.minSPS=e.minSPS<0?0:e.minSPS,this.uploadST=+new Date,e.sendLog(2,{code:t.eCode,message:n["e_"+(t.eCode?t.eCode:3)]}),e.updateStatus(5),e.onUploadError||(e.onUploadError=function(){return function(t,e){alert("Error code is "+t+", Error Message: "+e)}}()),e.onUploadError.call(e,t.eCode,t.msg)},sendLog:function(t,e){var n=parseInt(+new Date);pplog.addLog({lt:5,c:parseInt(this.userId),vid:parseInt(this.cid),end:n,et:parseInt(this.uploadST),net:5,mxs:1e3*(this.maxSPS?this.maxSPS:0),mns:1e3*(this.minSPS?this.minSPS:0),src:2,stu:t||1,err:e||"",vs:parseInt(this.size)}),pplog.sendLog()}},window.UploadFile=window.UploadFile||s}(),function(){var t=document,e=UTIL.isIE,n=UTIL.addDomEvent,r=UTIL.removeDomEvent,i=UTIL.ensureAfterDomRenderer,a=function(t){for(var e=t,n=["","K","M","G","T","P"],r=0;e>=1024;)e/=1024,r++;return e.toFixed(2)+n[r]+"B"},o=function(t){var e={b:1,kb:1024,mb:1048576,gb:1073741824,tb:1099511627776,pb:0x4000000000000};t=""+t;var n=t.match(/([0-9]+)/g),r=t.match(/([A-Za-z]+)/g);return r&&r.length&&r[0]?e[r[0].toLowerCase()]*n[0]:+n[0]},s=function(t){if(!t)return!1;var e=this.types,n=t.lastIndexOf(".");if(n<0)return!1;0==n&&(n=-1),n=t.substr(n+1,t.length-1),n=n.toLowerCase();for(var r=0,i=e.length;r<i;r++)if(n==e[r])return!0;return!1},u=function(t,e){for(var n=0,r=e.length;n<r;n++)if(e[n]==t)return!0;return!1},l=function(e){var n=t.createElement("input");return n.setAttribute("type","file"),e.multiple&&n.setAttribute("multiple","multiple"),n},f=function(){var r=this,a=l(r);this.fileChoose=a,n(a,"change",function(){h.call(r)}),e&&(a.style.position="absolute",a.style.left="-1000000px",t.body.appendChild(a)),i(function(){a&&a.click()},a)},h=function(){var t=this.fileChoose,e=this,n=this.maxFileLength;if(t){for(var r=t.files,i=0,o=r.length;i<o;i++){if(this.filesLength>=n)return;var u=r[i],l=u.name,f=u.size;this.files.length;if(s.call(this,l)){if(f>=e.singleFileMaxLimit){if(this.checkSizeMessage){var f=u.size;this.checkSizeMessage.call(this,u,f)}}else if(!e.validate||e.validate.call(this,u)){var h=e.files.length,c=new UploadFile({channelname:l,size:f,changeSize:a(f),index:h,fileInput:e.fileChoose,tokenURL:e.tokenURL,blobFile:u,fileIndex:i,viewNode:null,status:0,customParams:e.customParams,isAutoUpload:e.isAutoUpload,cusTokenError:e.cusTokenError,onProgress:e.onProgress,onUploadError:e.onUploadError,afterEachFinished:e.afterEachFinished,onUpdateStatus:e.onUpdateStatus,isDebug:e.isDebug,onSpeed:e.onSpeed,onAfterChangeFiles:function(t){e.onAfterChangeFiles&&e.onAfterChangeFiles.call(e,t)}});e.files.push(c),e.filesLength++,featureFile.addTask(c)}}else if(this.checkTypeMessage){var p=l.split(".")[1];this.checkTypeMessage.call(this,u,p)}}featureFile.loadFile()}},c=function(n){var a=this,o=this.files[n];o&&(3!=o.getStutas()&&4!=o.getStutas()&&o.setPause(3),o.fileInput&&(this.files[n]=null,r(o.fileInput,"change",function(){}),e&&t.body.removeChild(o.fileInput),i(function(){o.fileInput=null,o=null,a.filesLength--},a)))},p=function(){for(var t=this.files,e=0,n=t.length;e<n;e++)t[e]&&c(e)},d=function(t){var e=this.files[t];if(e){var n=e.getStutas();0!=n&&3!=n&&5!=n||e.upload()}},g=function(){for(var t=this.files,e=0,n=t.length;e<n;e++)t[e]&&d(e)},m=function(t){var e=this.files[t];if(e){3!=e.getStutas()&&e.setPause(3)}},v=function(){for(var t=this.files,e=0,n=t.length;e<n;e++)t[e]&&m(e)},y=function(){var t=this;this.uploadDom&&i(function(){n(t.uploadDom,"click",function(){f.call(t)})},t)},S=function(t){if(t=t||{},this.files=[],this.fileChoose=null,this.uploadDom=t.uploadDom||null,this.username=t.username||"",this.apikey=t.apikey||"",this.maxFileLength=t.maxFileLength||10,this.singleFileMaxLimit=t.singleFileMaxLimit?t.singleFileMaxLimit:107374182400,this.maxLimit=o(t.maxLimit?t.maxLimit:107374182400),this.maxLimit=t.maxLimit?t.maxLimit:107374182400,this.customParams=t.customParams||{},this.filesLength=0,this.isAutoUpload=new Boolean(!1|("isAutoUpload"in t&&new Boolean(t.isAutoUpload))).valueOf(),this.multiple=new Boolean(!1|("multiple"in t&&new Boolean(t.multiple))).valueOf(),this.isNotPPtype=new Boolean(!1|("isNotPPtype"in t&&new Boolean(t.isNotPPtype))).valueOf(),this.customTypes=t.customTypes||[],this.types=["wma","wmv","avi","wm","asf","rm","rmvb","mpeg","mpg","ts","mp4","mpeg4","mov","qt","3gp","mkv","mka","vob","flv"],this.isNotPPtype)this.types=this.customTypes;else if(this.customTypes.length>0)for(var e=0,n=this.customTypes.length;e<n;e++){var r=this.customTypes[e]?this.customTypes[e]:"";r=r.toLowerCase(),u(r,this.types)||this.types.push(r)}this.tokenURL=t.tokenURL||"",this.validate=t.validate||null,this.checkTypeMessage=t.checkTypeMessage||null,this.checkSizeMessage=t.checkSizeMessage||null,this.onProgress=t.onProgress||null,this.onUploadError=t.onUploadError||null,this.afterEachFinished=t.afterEachFinished||null,this.onAfterChangeFiles=t.onAfterChangeFiles||null,this.isDebug=t.isDebug,this.onSameFile=t.onSameFile||null,this.onUpdateStatus=t.onUpdateStatus||null,this.cusTokenError=t.cusTokenError||null,this.onSpeed=t.onSpeed||null};S.prototype={init:function(t){t.call(this),y.call(this)},pauseUpload:function(t){m.call(this,t)},pauseUploadAll:function(){v.call(this)},startUpload:function(t){d.call(this,t)},starUploadAll:function(){g.call(this)},deleteFile:function(t){c.call(this,t)},deleteFileAll:function(){p.call(this)}},window.PDIKit=window.PDIKit||{},window.PDIKit.Upload=window.PDIKit.Upload||S}();